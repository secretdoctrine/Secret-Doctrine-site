- node_class = 'jstree-open'
- node_class += ' jstree-add'
- node_class += ' jstree-book-add'
- node_class += ' jstree-edit' unless book_category.is_root

%li{:id => "book_category_" + book_category.id.to_s,
    :edit_path => refinery.edit_books_admin_book_category_path(book_category.id),
    :new_path => refinery.new_books_admin_book_category_path + '?book_category_id=' + book_category.id.to_s,
    :new_book_path => refinery.new_books_admin_book_path + '?book_category_id=' + book_category.id.to_s,
    :class => node_class,
    :update_path => refinery.books_admin_book_category_path(book_category.id),
    :node_type => :category}
  = book_category.name
  - book_category.children_array.each do |child|
    %ul
      - if child.is_a?(Refinery::Books::BookCategory)
        = render :partial => 'book_category_tree_element', :locals => {book_category: child}
      - else
        = render :partial => 'book_category_book_element', :locals => {book: child}
